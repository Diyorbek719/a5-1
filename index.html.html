<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A5/1 Kriptografiya Kursi</title>
<link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
<style>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   COURSERA-STYLE DESIGN SYSTEM
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
:root {
  --blue:      #0056d2;
  --blue-dark: #003a8c;
  --blue-mid:  #1570ef;
  --blue-light:#e8f0fe;
  --blue-pale: #f0f6ff;
  --teal:      #00a3a3;
  --yellow:    #f5b800;
  --green:     #1a7f64;
  --green-l:   #e6f4f1;
  --red:       #c0392b;
  --red-l:     #fdf0ef;
  --c1:        #0056d2;
  --c2:        #00a3a3;
  --c3:        #1a7f64;
  --c1l:       rgba(0,86,210,0.10);
  --c2l:       rgba(0,163,163,0.10);
  --c3l:       rgba(26,127,100,0.10);
  --c1m:       rgba(0,86,210,0.22);
  --c2m:       rgba(0,163,163,0.22);
  --c3m:       rgba(26,127,100,0.22);

  --bg:        #f9fafb;
  --white:     #ffffff;
  --gray-50:   #f9fafb;
  --gray-100:  #f3f4f6;
  --gray-200:  #e5e7eb;
  --gray-300:  #d1d5db;
  --gray-500:  #6b7280;
  --gray-600:  #4b5563;
  --gray-700:  #374151;
  --gray-900:  #111827;
  --border:    #e5e7eb;
  --shadow-xs: 0 1px 2px rgba(0,0,0,0.05);
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.1),0 1px 2px rgba(0,0,0,0.06);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.07),0 2px 4px rgba(0,0,0,0.06);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.1),0 4px 6px rgba(0,0,0,0.05);
  --r:         8px;
  --r-lg:      12px;
}

*{box-sizing:border-box;margin:0;padding:0;}
html{font-size:16px;}

body {
  font-family: 'Source Sans 3', -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--bg);
  color: var(--gray-900);
  min-height: 100vh;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

/* ‚îÄ‚îÄ‚îÄ ANIMATED BACKGROUND CANVAS ‚îÄ‚îÄ‚îÄ */
#bgc {
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
}

/* ‚îÄ‚îÄ‚îÄ TOP NAV BAR (Coursera style) ‚îÄ‚îÄ‚îÄ */
.topbar {
  position: sticky; top: 0; z-index: 100;
  background: var(--white);
  border-bottom: 1px solid var(--border);
  box-shadow: var(--shadow-xs);
}
.topbar-inner {
  max-width: 1280px; margin: 0 auto;
  padding: 0 24px;
  height: 60px;
  display: flex; align-items: center; gap: 32px;
}
.logo {
  display: flex; align-items: center; gap: 10px;
  text-decoration: none;
}
.logo-icon {
  width: 36px; height: 36px; border-radius: 8px;
  background: var(--blue);
  display: flex; align-items: center; justify-content: center;
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px; font-weight: 700; color: #fff;
}
.logo-text {
  font-size: 18px; font-weight: 700; color: var(--blue);
  letter-spacing: -0.3px;
}
.topbar-nav {
  display: flex; align-items: center; gap: 6px;
  flex: 1;
}
.topnav-btn {
  padding: 7px 16px; border-radius: var(--r);
  border: none; background: transparent;
  font-family: 'Source Sans 3', sans-serif;
  font-size: 14px; font-weight: 600;
  color: var(--gray-600); cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}
.topnav-btn:hover { background: var(--gray-100); color: var(--gray-900); }
.topnav-btn.active { background: var(--blue-light); color: var(--blue); }

.topbar-right {
  display: flex; align-items: center; gap: 12px; margin-left: auto;
}
.prog-pill {
  display: flex; align-items: center; gap: 8px;
  background: var(--gray-100); border-radius: 20px;
  padding: 5px 14px;
  font-size: 13px; font-weight: 600; color: var(--gray-700);
}
.prog-pill .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--blue); }

/* ‚îÄ‚îÄ‚îÄ HERO BANNER (Coursera course header) ‚îÄ‚îÄ‚îÄ */
.hero {
  background: linear-gradient(135deg, var(--blue-dark) 0%, var(--blue) 60%, #1570ef 100%);
  color: #fff;
  position: relative; overflow: hidden;
  z-index: 1;
}
.hero::before {
  content: '';
  position: absolute; inset: 0;
  background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
.hero-inner {
  max-width: 1280px; margin: 0 auto; padding: 48px 24px 44px;
  display: grid; grid-template-columns: 1fr auto;
  gap: 40px; align-items: center;
  position: relative; z-index: 1;
}
.hero-breadcrumb {
  font-size: 13px; color: rgba(255,255,255,0.7);
  margin-bottom: 12px; display: flex; align-items: center; gap: 6px;
}
.hero-breadcrumb span { color: rgba(255,255,255,0.5); }
.hero-title {
  font-size: clamp(24px, 3.5vw, 38px);
  font-weight: 700; line-height: 1.15;
  letter-spacing: -0.5px; margin-bottom: 12px;
}
.hero-sub {
  font-size: 16px; color: rgba(255,255,255,0.85);
  line-height: 1.5; margin-bottom: 20px; max-width: 560px;
}
.hero-tags { display: flex; gap: 8px; flex-wrap: wrap; }
.hero-tag {
  padding: 4px 12px; border-radius: 20px;
  background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.25);
  font-size: 12px; font-weight: 600; color: rgba(255,255,255,0.9);
  letter-spacing: 0.3px;
}
.hero-card {
  background: var(--white); border-radius: var(--r-lg);
  padding: 24px; min-width: 240px;
  box-shadow: var(--shadow-lg);
  color: var(--gray-900);
}
.hero-card-title {
  font-size: 13px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 1px; color: var(--gray-500); margin-bottom: 16px;
}
.reg-stat {
  display: flex; align-items: center; gap: 12px;
  padding: 8px 0; border-bottom: 1px solid var(--border);
}
.reg-stat:last-child { border: none; }
.reg-dot {
  width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0;
}
.rd1{background:var(--c1)} .rd2{background:var(--c2)} .rd3{background:var(--c3)}
.reg-stat-text { font-size: 14px; font-weight: 600; color: var(--gray-700); }
.reg-stat-sub { font-size: 12px; color: var(--gray-500); font-family: 'JetBrains Mono', monospace; }

/* ‚îÄ‚îÄ‚îÄ MAIN LAYOUT ‚îÄ‚îÄ‚îÄ */
.main {
  max-width: 1280px; margin: 0 auto;
  padding: 32px 24px;
  display: grid;
  grid-template-columns: 260px 1fr;
  gap: 32px;
  position: relative; z-index: 1;
}
@media(max-width:900px){.main{grid-template-columns:1fr;}.sidebar{display:none;}}

/* ‚îÄ‚îÄ‚îÄ SIDEBAR (Coursera course menu) ‚îÄ‚îÄ‚îÄ */
.sidebar {
  position: sticky; top: 80px; height: fit-content;
}
.sidebar-section {
  background: var(--white); border: 1px solid var(--border);
  border-radius: var(--r-lg); overflow: hidden;
  box-shadow: var(--shadow-sm);
  margin-bottom: 16px;
}
.sidebar-head {
  padding: 14px 16px;
  background: var(--gray-50); border-bottom: 1px solid var(--border);
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 1.2px; color: var(--gray-500);
}
.sidebar-item {
  display: flex; align-items: center; gap: 12px;
  padding: 12px 16px; cursor: pointer;
  border-bottom: 1px solid var(--border);
  transition: all 0.15s;
  border: none; background: transparent; width: 100%; text-align: left;
}
.sidebar-item:last-child { border-bottom: none; }
.sidebar-item:hover { background: var(--blue-pale); }
.sidebar-item.active { background: var(--blue-light); border-left: 3px solid var(--blue); }
.sidebar-item .si-icon {
  width: 32px; height: 32px; border-radius: 6px; flex-shrink: 0;
  display: flex; align-items: center; justify-content: center; font-size: 15px;
  background: var(--gray-100);
}
.sidebar-item.active .si-icon { background: var(--blue-light); }
.si-text { display: flex; flex-direction: column; gap: 2px; }
.si-label { font-size: 14px; font-weight: 600; color: var(--gray-700); }
.sidebar-item.active .si-label { color: var(--blue); }
.si-sub { font-size: 12px; color: var(--gray-500); }

.sidebar-info {
  background: var(--white); border: 1px solid var(--border);
  border-radius: var(--r-lg); padding: 16px;
  box-shadow: var(--shadow-sm);
}
.info-row {
  display: flex; align-items: center; gap: 10px;
  padding: 8px 0; border-bottom: 1px solid var(--border);
  font-size: 13px;
}
.info-row:last-child { border: none; }
.info-row .ir-icon { font-size: 16px; width: 24px; text-align: center; }
.info-row .ir-text { color: var(--gray-600); }
.info-row .ir-val { color: var(--gray-900); font-weight: 600; margin-left: auto; }

/* ‚îÄ‚îÄ‚îÄ CONTENT AREA ‚îÄ‚îÄ‚îÄ */
.content { min-width: 0; }
.tab { display: none; }
.tab.on { display: block; animation: fadeUp 0.3s ease; }
@keyframes fadeUp { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:translateY(0)} }

/* ‚îÄ‚îÄ‚îÄ SECTION HEADER (Coursera module style) ‚îÄ‚îÄ‚îÄ */
.module-header {
  display: flex; align-items: center; gap: 12px;
  margin-bottom: 24px; padding-bottom: 16px;
  border-bottom: 2px solid var(--border);
}
.module-num {
  width: 36px; height: 36px; border-radius: 8px;
  background: var(--blue); color: #fff;
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; font-weight: 700; flex-shrink: 0;
}
.module-title { font-size: 22px; font-weight: 700; color: var(--gray-900); }
.module-sub { font-size: 14px; color: var(--gray-500); margin-top: 2px; }

/* ‚îÄ‚îÄ‚îÄ CARDS ‚îÄ‚îÄ‚îÄ */
.card {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: var(--r-lg);
  padding: 24px;
  box-shadow: var(--shadow-sm);
  margin-bottom: 16px;
}
.card-label {
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 1.2px; color: var(--gray-500);
  margin-bottom: 14px; padding-bottom: 10px;
  border-bottom: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
}
.card-label.lb1{color:var(--c1)} .card-label.lb2{color:var(--c2)} .card-label.lb3{color:var(--c3)}

/* ‚îÄ‚îÄ‚îÄ THEORY ‚îÄ‚îÄ‚îÄ */
.two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
@media(max-width:640px){.two-col{grid-template-columns:1fr}}
.full-col { grid-column: 1/-1; }

.info-text { font-size: 15px; line-height: 1.75; color: var(--gray-600); }
.info-text strong { color: var(--gray-900); font-weight: 600; }

.rtbl { width:100%; border-collapse:collapse; font-family:'JetBrains Mono',monospace; font-size:13px; }
.rtbl tr { border-bottom: 1px solid var(--border); }
.rtbl tr:last-child { border:none; }
.rtbl td { padding: 9px 0; }
.rtbl td:first-child { color: var(--gray-500); font-size: 12px; }
.rtbl td:last-child { font-weight: 700; text-align: right; }
.v1{color:var(--c1)!important} .v2{color:var(--c2)!important} .v3{color:var(--c3)!important}

.code-block {
  background: var(--gray-900); color: #a5f3fc;
  font-family: 'JetBrains Mono', monospace; font-size: 13px;
  padding: 14px 16px; border-radius: var(--r); margin-top: 12px;
  letter-spacing: 0.3px; font-weight: 500;
  border-left: 3px solid var(--blue);
}
.code-block.c2{color:#6ee7b7;border-color:var(--c2)}
.code-block.c3{color:#a7f3d0;border-color:var(--c3)}

/* ‚îÄ‚îÄ‚îÄ LFSR REGISTER ‚îÄ‚îÄ‚îÄ */
.lfsr-card {
  background: var(--white); border: 1px solid var(--border);
  border-radius: var(--r-lg); padding: 20px 22px;
  margin-bottom: 12px; box-shadow: var(--shadow-sm);
  transition: border-color 0.25s, box-shadow 0.25s;
}
.lfsr-card.fire1{border-color:var(--c1);border-width:2px;box-shadow:0 0 0 4px var(--c1l),var(--shadow-md);}
.lfsr-card.fire2{border-color:var(--c2);border-width:2px;box-shadow:0 0 0 4px var(--c2l),var(--shadow-md);}
.lfsr-card.fire3{border-color:var(--c3);border-width:2px;box-shadow:0 0 0 4px var(--c3l),var(--shadow-md);}

.lfsr-head {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 18px;
}
.lfsr-title { font-size: 14px; font-weight: 700; font-family: 'JetBrains Mono', monospace; }
.lfsr-title.t1{color:var(--c1)} .lfsr-title.t2{color:var(--c2)} .lfsr-title.t3{color:var(--c3)}
.lfsr-badge {
  font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--gray-500);
  background: var(--gray-100); border: 1px solid var(--border);
  border-radius: 6px; padding: 3px 10px;
}

.bits-row { display: flex; gap: 2px; flex-wrap: wrap; }
.bit {
  width: 27px; height: 31px;
  display: flex; align-items: center; justify-content: center;
  font-family: 'JetBrains Mono', monospace; font-size: 12px; font-weight: 700;
  border-radius: 5px; border: 1.5px solid var(--border);
  background: var(--gray-50); color: var(--gray-400);
  position: relative; transition: all 0.15s; margin-bottom: 18px; cursor: default;
}
.bit-i{position:absolute;top:-15px;font-size:8px;color:var(--gray-400);font-family:'JetBrains Mono',monospace;}
.bit-c{position:absolute;bottom:-16px;font-size:8px;color:var(--gray-700);font-family:'JetBrains Mono',monospace;white-space:nowrap;font-weight:700;}
.bit.on1{background:var(--c1l);border-color:var(--c1);color:var(--c1);}
.bit.on2{background:var(--c2l);border-color:var(--c2);color:var(--c2);}
.bit.on3{background:var(--c3l);border-color:var(--c3);color:var(--c3);}
.bit.tp1{box-shadow:0 0 0 2px rgba(0,86,210,0.35);}
.bit.tp2{box-shadow:0 0 0 2px rgba(0,163,163,0.35);}
.bit.tp3{box-shadow:0 0 0 2px rgba(26,127,100,0.35);}
.bit.pop{animation:bpop .3s cubic-bezier(.34,1.56,.64,1);}
@keyframes bpop{0%,100%{transform:scale(1)}45%{transform:scale(1.3) translateY(-2px)}}

/* ‚îÄ‚îÄ‚îÄ MAJORITY PANEL ‚îÄ‚îÄ‚îÄ */
.maj-panel {
  background: var(--gray-900);
  border-radius: var(--r-lg); padding: 20px 24px;
  margin-bottom: 14px;
  display: flex; align-items: center; gap: 18px; flex-wrap: wrap;
}
.mcell { display: flex; flex-direction: column; align-items: center; gap: 5px; }
.mcell .ml { font-family:'JetBrains Mono',monospace; font-size:9px; letter-spacing:2px; text-transform:uppercase; color:rgba(255,255,255,0.45); }
.mcell .mb {
  width:46px; height:46px; border-radius:10px;
  display:flex; align-items:center; justify-content:center;
  font-family:'JetBrains Mono',monospace; font-size:22px; font-weight:700;
  border: 1.5px solid rgba(255,255,255,0.1);
}
.mcell.mc1 .mb{background:var(--c1l);border-color:var(--c1);color:var(--c1);}
.mcell.mc2 .mb{background:var(--c2l);border-color:var(--c2);color:var(--c2);}
.mcell.mc3 .mb{background:var(--c3l);border-color:var(--c3);color:var(--c3);}
.mcell.mcm .mb{background:rgba(255,255,255,0.08);border-color:rgba(255,255,255,0.2);color:#fff;}
.marr{font-size:20px;color:rgba(255,255,255,0.25);}
.maj-info-text{margin-left:auto;font-family:'JetBrains Mono',monospace;font-size:11px;line-height:2;color:rgba(255,255,255,0.45);}

/* ‚îÄ‚îÄ‚îÄ CONTROLS ‚îÄ‚îÄ‚îÄ */
.ctrl-bar {
  background: var(--white); border: 1px solid var(--border);
  border-radius: var(--r-lg); padding: 14px 18px;
  display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
  box-shadow: var(--shadow-sm); margin-bottom: 14px;
}

.btn {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 9px 18px; border-radius: var(--r);
  font-family: 'Source Sans 3', sans-serif; font-size: 14px; font-weight: 700;
  cursor: pointer; transition: all 0.15s; white-space: nowrap;
  border: 1.5px solid var(--border); background: var(--gray-50); color: var(--gray-700);
}
.btn:hover{background:var(--gray-100);border-color:var(--gray-300);color:var(--gray-900);}
.btn-primary {
  background: var(--blue); border-color: var(--blue); color: #fff;
  box-shadow: 0 1px 2px rgba(0,86,210,0.2);
}
.btn-primary:hover{background:var(--blue-dark);border-color:var(--blue-dark);}
.btn-danger{border-color:#fca5a5;color:var(--red);}
.btn-danger:hover{background:var(--red-l);border-color:var(--red);}
.btn-ghost{background:transparent;border-color:transparent;color:var(--blue);font-size:13px;padding:7px 14px;}
.btn-ghost:hover{background:var(--blue-light);}
.btn.disabled{opacity:0.45;pointer-events:none;}

.num-field {
  display: flex; align-items: center; gap: 8px;
  background: var(--gray-50); border: 1.5px solid var(--border);
  border-radius: var(--r); padding: 7px 12px;
}
.num-field label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--gray-500);}
.num-field input[type=number]{
  width:68px; background:transparent; border:none; outline:none;
  font-family:'JetBrains Mono',monospace; font-size:14px; font-weight:700;
  color:var(--blue); text-align:center;
}
.num-field .ustr{font-size:11px;color:var(--gray-400);font-family:'JetBrains Mono',monospace;}
.step-ctr{margin-left:auto;font-size:13px;color:var(--gray-500);font-family:'JetBrains Mono',monospace;}
.step-ctr b{color:var(--blue);}

/* ‚îÄ‚îÄ‚îÄ KEYSTREAM ‚îÄ‚îÄ‚îÄ */
.ks-card{background:var(--white);border:1px solid var(--border);border-radius:var(--r-lg);padding:18px 20px;margin-bottom:12px;box-shadow:var(--shadow-sm);}
.ks-label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1.2px;color:var(--gray-500);margin-bottom:12px;}
.ks-bits{display:flex;gap:3px;flex-wrap:wrap;min-height:32px;}
.ksb{
  width:24px;height:28px;border-radius:5px;
  display:flex;align-items:center;justify-content:center;
  font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:700;
  animation:kpop .2s cubic-bezier(.34,1.56,.64,1);
}
@keyframes kpop{from{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}
.ksb.k0{background:var(--c1l);color:var(--c1);border:1.5px solid var(--c1m);}
.ksb.k1{background:var(--c2l);color:var(--c2);border:1.5px solid var(--c2m);}

/* ‚îÄ‚îÄ‚îÄ LOG ‚îÄ‚îÄ‚îÄ */
.log-head{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1.2px;color:var(--gray-500);margin-bottom:8px;}
.log-box{
  background:var(--gray-900);border-radius:var(--r);
  padding:14px 16px;font-family:'JetBrains Mono',monospace;font-size:11px;
  max-height:160px;overflow-y:auto;line-height:2;color:rgba(255,255,255,0.4);
}
.log-box .ln{color:rgba(255,255,255,0.3);}
.log-box .lc{color:#60a5fa;font-weight:700;}
.log-box .lo{color:#6ee7b7;font-weight:700;}
.log-box .lw{color:#fbbf24;}
::-webkit-scrollbar{width:4px;} ::-webkit-scrollbar-track{background:transparent;} ::-webkit-scrollbar-thumb{background:var(--gray-300);border-radius:4px;}

/* ‚îÄ‚îÄ‚îÄ FORM FIELDS ‚îÄ‚îÄ‚îÄ */
.form-group{display:flex;flex-direction:column;gap:6px;}
.form-label{font-size:13px;font-weight:600;color:var(--gray-700);}
.form-input{
  background:var(--white);border:1.5px solid var(--border);border-radius:var(--r);
  padding:10px 14px;font-family:'JetBrains Mono',monospace;font-size:14px;
  color:var(--gray-900);outline:none;transition:border-color 0.15s,box-shadow 0.15s;
}
.form-input:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(0,86,210,0.12);}
.form-hint{font-size:12px;color:var(--gray-500);}

.grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;margin-bottom:16px;}
@media(max-width:560px){.grid-3{grid-template-columns:1fr;}}
.btn-row{display:flex;gap:10px;flex-wrap:wrap;}

/* ‚îÄ‚îÄ‚îÄ ENCRYPT RESULT ‚îÄ‚îÄ‚îÄ */
.enc-row{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:10px;}
.enc-l{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--gray-500);width:92px;flex-shrink:0;}
.enc-bits{display:flex;gap:2px;flex-wrap:wrap;}
.eb{width:22px;height:26px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:700;}
.ep{background:var(--gray-100);color:var(--gray-700);border:1.5px solid var(--border);}
.ek{background:var(--c1l);color:var(--c1);border:1.5px solid var(--c1m);}
.ec{background:var(--c2l);color:var(--c2);border:1.5px solid var(--c2m);}
.xop{font-size:16px;color:var(--gray-400);}
.hex-tag{font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:700;background:var(--gray-900);color:#a5f3fc;padding:4px 10px;border-radius:5px;}

/* ‚îÄ‚îÄ‚îÄ QUIZ ‚îÄ‚îÄ‚îÄ */
.qprog-wrap{background:var(--gray-200);border-radius:4px;height:5px;margin-bottom:20px;overflow:hidden;}
.qprog-fill{height:100%;background:var(--blue);border-radius:4px;transition:width 0.4s ease;}
.q-meta{display:flex;justify-content:space-between;font-size:13px;color:var(--gray-500);font-weight:600;margin-bottom:14px;}
.q-text{font-size:18px;font-weight:700;line-height:1.5;margin-bottom:22px;color:var(--gray-900);}
.q-opts{display:flex;flex-direction:column;gap:10px;}
.q-opt{
  display:flex;align-items:center;gap:14px;
  padding:14px 16px;border-radius:var(--r);
  background:var(--white);border:1.5px solid var(--border);
  cursor:pointer;transition:all 0.15s;
  font-size:15px;font-weight:500;color:var(--gray-700);text-align:left;
}
.q-opt:hover:not(:disabled){border-color:var(--blue);background:var(--blue-pale);color:var(--blue);}
.q-opt .qk{
  width:28px;height:28px;border-radius:50%;flex-shrink:0;
  background:var(--gray-100);border:1.5px solid var(--border);
  display:flex;align-items:center;justify-content:center;
  font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:700;color:var(--gray-500);
}
.q-opt:hover:not(:disabled) .qk{background:var(--blue-light);border-color:var(--blue);color:var(--blue);}
.q-opt.ok{border-color:var(--green);background:var(--green-l);color:var(--green);}
.q-opt.ok .qk{background:var(--green-l);border-color:var(--green);color:var(--green);}
.q-opt.fail{border-color:var(--red);background:var(--red-l);color:var(--red);}
.q-opt.fail .qk{background:var(--red-l);border-color:var(--red);color:var(--red);}

/* ‚îÄ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ‚îÄ */
.footer {
  background: var(--gray-900); color: rgba(255,255,255,0.5);
  text-align: center; padding: 24px;
  font-size: 13px; margin-top: 40px;
  position: relative; z-index: 1;
}
.footer strong { color: rgba(255,255,255,0.8); }
</style>
</head>
<body>

<canvas id="bgc"></canvas>

<!-- TOP NAV -->
<div class="topbar">
  <div class="topbar-inner">
    <div class="logo">
      <div class="logo-icon">A5/1</div>
      <div class="logo-text">CryptoLearn</div>
    </div>

    <div class="topbar-right">
      <div class="prog-pill"><span class="dot"></span>A5/1 Kursi</div>
    </div>
  </div>
</div>

<!-- HERO -->
<div class="hero">
  <div class="hero-inner">
    <div>
      <div class="hero-breadcrumb">
        Kriptografiya <span>‚Ä∫</span> Stream Cipher <span>‚Ä∫</span> A5/1
      </div>
      <div class="hero-title">A5/1 Algoritmi ‚Äî Interaktiv Kurs</div>
      <div class="hero-sub">GSM mobil aloqasida ishlatiladigan oqim shifri. LFSR registrlar, majority rule va keystream generatsiyasini bosqichma-bosqich o'rganing.</div>
      <div class="hero-tags">
        <span class="hero-tag">Stream Cipher</span>
        <span class="hero-tag">3√ó LFSR</span>
        <span class="hero-tag">GSM Xavfsizlik</span>
        <span class="hero-tag">XOR Shifrlash</span>
        <span class="hero-tag">25 Savol</span>
      </div>
    </div>
    <div class="hero-card">
      <div class="hero-card-title">Registr Tuzilishi</div>
      <div class="reg-stat">
        <span class="reg-dot rd1"></span>
        <div>
          <div class="reg-stat-text">R1 ‚Äî 19 bit</div>
          <div class="reg-stat-sub">tap:[13,16,17,18]</div>
        </div>
      </div>
      <div class="reg-stat">
        <span class="reg-dot rd2"></span>
        <div>
          <div class="reg-stat-text">R2 ‚Äî 22 bit</div>
          <div class="reg-stat-sub">tap:[20,21]</div>
        </div>
      </div>
      <div class="reg-stat">
        <span class="reg-dot rd3"></span>
        <div>
          <div class="reg-stat-text">R3 ‚Äî 23 bit</div>
          <div class="reg-stat-sub">tap:[7,20,21,22]</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MAIN -->
<div class="main">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-head">Kurs Bo'limlari</div>
      <button class="sidebar-item active" onclick="go('theory')">
        <div class="si-icon">üìñ</div>
        <div class="si-text"><span class="si-label">Nazariya</span><span class="si-sub">A5/1 asoslari</span></div>
      </button>
      <button class="sidebar-item" onclick="go('vis')">
        <div class="si-icon">‚öôÔ∏è</div>
        <div class="si-text"><span class="si-label">Vizualizatsiya</span><span class="si-sub">Jonli simulyatsiya</span></div>
      </button>
      <button class="sidebar-item" onclick="go('enc')">
        <div class="si-icon">üîê</div>
        <div class="si-text"><span class="si-label">Shifrlash</span><span class="si-sub">Amaliy misol</span></div>
      </button>
      <button class="sidebar-item" onclick="go('quiz')">
        <div class="si-icon">üß™</div>
        <div class="si-text"><span class="si-label">Test</span><span class="si-sub">25 savol</span></div>
      </button>
    </div>
    <div class="sidebar-info">
      <div class="info-row"><span class="ir-icon">‚è±</span><span class="ir-text">Davomiylik</span><span class="ir-val">~45 min</span></div>
      <div class="info-row"><span class="ir-icon">üìä</span><span class="ir-text">Daraja</span><span class="ir-val">O'rta</span></div>
      <div class="info-row"><span class="ir-icon">üèÜ</span><span class="ir-text">Sertifikat</span><span class="ir-val">Test ‚â•80%</span></div>
      <div class="info-row"><span class="ir-icon">üåê</span><span class="ir-text">Til</span><span class="ir-val">O'zbek</span></div>
    </div>
  </aside>

  <!-- CONTENT -->
  <div class="content">

    <!-- ‚ïê‚ïê THEORY ‚ïê‚ïê -->
    <div id="t-theory" class="tab on">
      <div class="module-header">
        <div class="module-num">1</div>
        <div><div class="module-title">Nazariya</div><div class="module-sub">A5/1 algoritmi asoslari va tuzilishi</div></div>
      </div>

      <div class="card full-col">
        <div class="card-label">A5/1 Haqida Umumiy Ma'lumot</div>
        <p class="info-text">
          <strong>A5/1</strong> ‚Äî 1987-yilda ishlab chiqilgan va hozirda ham <strong>GSM mobil aloqa standartida</strong> ovozli suhbat va SMS xabarlarni himoya qilishda ishlatiladigan <strong>oqim shifri (stream cipher)</strong>. U uchta xil uzunlikdagi <strong>LFSR (Linear Feedback Shift Register)</strong> registrlar kombinatsiyasidan tashkil topgan. <strong>Ko'pchilik qoidasi (majority rule)</strong> qaysi registrlar siljishini boshqaradi ‚Äî bu <strong>irregular clocking</strong> deb ataladi va shifrning kriptografik kuchini sezilarli oshiradi. Registrlar chiqish bitleri XOR orqali keystream hosil qiladi va u asl ma'lumot bilan XOR qilinadi.
        </p>
        <div class="code-block">keystream_bit = R1[18] ‚äï R2[21] ‚äï R3[22]</div>
      </div>

      <div class="two-col">
        <div class="card">
          <div class="card-label lb1">R1 ‚Äî Registr 1</div>
          <table class="rtbl">
            <tr><td>Uzunlik</td><td class="v1">19 bit</td></tr>
            <tr><td>Tap pozitsiyalar</td><td class="v1">13, 16, 17, 18</td></tr>
            <tr><td>Clocking biti</td><td class="v1">bit[8]</td></tr>
            <tr><td>Chiqish biti</td><td class="v1">bit[18]</td></tr>
          </table>
          <div class="code-block">b[13] ‚äï b[16] ‚äï b[17] ‚äï b[18]</div>
        </div>
        <div class="card">
          <div class="card-label lb2">R2 ‚Äî Registr 2</div>
          <table class="rtbl">
            <tr><td>Uzunlik</td><td class="v2">22 bit</td></tr>
            <tr><td>Tap pozitsiyalar</td><td class="v2">20, 21</td></tr>
            <tr><td>Clocking biti</td><td class="v2">bit[10]</td></tr>
            <tr><td>Chiqish biti</td><td class="v2">bit[21]</td></tr>
          </table>
          <div class="code-block c2">b[20] ‚äï b[21]</div>
        </div>
        <div class="card">
          <div class="card-label lb3">R3 ‚Äî Registr 3</div>
          <table class="rtbl">
            <tr><td>Uzunlik</td><td class="v3">23 bit</td></tr>
            <tr><td>Tap pozitsiyalar</td><td class="v3">7, 20, 21, 22</td></tr>
            <tr><td>Clocking biti</td><td class="v3">bit[10]</td></tr>
            <tr><td>Chiqish biti</td><td class="v3">bit[22]</td></tr>
          </table>
          <div class="code-block c3">b[7] ‚äï b[20] ‚äï b[21] ‚äï b[22]</div>
        </div>
        <div class="card">
          <div class="card-label">Ko'pchilik Qoidasi ‚Äî Majority Rule</div>
          <p class="info-text">
            Har bir soat zarbida <strong>R1[8]</strong>, <strong>R2[10]</strong>, <strong>R3[10]</strong> bitleri o'qiladi. Ko'pchilik qiymati (0 yoki 1) aniqlanadi. Faqat o'sha qiymatga teng clocking bitli registrlar siljiydi ‚Äî kamida 2 ta, ba'zan 3 ta.
          </p>
          <div class="code-block">majority(a,b,c) = (a‚àßb)‚à®(b‚àßc)‚à®(a‚àßc)</div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê VISUALIZER ‚ïê‚ïê -->
    <div id="t-vis" class="tab">
      <div class="module-header">
        <div class="module-num">2</div>
        <div><div class="module-title">Vizualizatsiya</div><div class="module-sub">A5/1 ishlashini jonli kuzating</div></div>
      </div>

      <div class="card">
        <div class="card-label">Boshlang'ich Holat (Seed)</div>
        <div class="grid-3">
          <div class="form-group">
            <label class="form-label">R1 ‚Äî 19 bit</label>
            <input class="form-input" type="text" id="s1" value="1ABCD" maxlength="8" placeholder="hex...">
            <span class="form-hint">Hexadecimal qiymat</span>
          </div>
          <div class="form-group">
            <label class="form-label">R2 ‚Äî 22 bit</label>
            <input class="form-input" type="text" id="s2" value="2F3A1" maxlength="8" placeholder="hex...">
          </div>
          <div class="form-group">
            <label class="form-label">R3 ‚Äî 23 bit</label>
            <input class="form-input" type="text" id="s3" value="5C2B7" maxlength="8" placeholder="hex...">
          </div>
        </div>
        <div class="btn-row">
          <button class="btn btn-primary" onclick="init()">‚ñ∂ Boshlash</button>
          <button class="btn" onclick="rnd()">üé≤ Tasodifiy</button>
        </div>
      </div>

      <div class="lfsr-card" id="pr1">
        <div class="lfsr-head"><span class="lfsr-title t1">R1 ‚Äî 19 bit</span><span class="lfsr-badge">tap:[13,16,17,18] ¬∑ clk:bit[8]</span></div>
        <div class="bits-row" id="br1"></div>
      </div>
      <div class="lfsr-card" id="pr2">
        <div class="lfsr-head"><span class="lfsr-title t2">R2 ‚Äî 22 bit</span><span class="lfsr-badge">tap:[20,21] ¬∑ clk:bit[10]</span></div>
        <div class="bits-row" id="br2"></div>
      </div>
      <div class="lfsr-card" id="pr3">
        <div class="lfsr-head"><span class="lfsr-title t3">R3 ‚Äî 23 bit</span><span class="lfsr-badge">tap:[7,20,21,22] ¬∑ clk:bit[10]</span></div>
        <div class="bits-row" id="br3"></div>
      </div>

      <div class="maj-panel">
        <div class="mcell mc1"><span class="ml">R1[8]</span><div class="mb" id="mj1">0</div></div>
        <div class="mcell mc2"><span class="ml">R2[10]</span><div class="mb" id="mj2">0</div></div>
        <div class="mcell mc3"><span class="ml">R3[10]</span><div class="mb" id="mj3">0</div></div>
        <span class="marr">‚Üí</span>
        <div class="mcell mcm"><span class="ml">Majority</span><div class="mb" id="mjv">‚Äî</div></div>
        <div class="maj-info-text" id="mji">Hali hisob yo'q</div>
      </div>

      <div class="ctrl-bar">
        <button class="btn btn-primary" onclick="s1()">‚ñ∂ 1 qadam</button>
        <div class="num-field">
          <label>N</label>
          <input type="number" id="ni" value="10" min="1" max="2000">
          <button onclick="sN()" class="btn-ghost btn" style="border:none;padding:4px 8px;min-width:auto">N qadam</button>
        </div>
        <div class="num-field">
          <label>TEZLIK</label>
          <input type="number" id="sp" value="200" min="10" max="5000" step="10">
          <span class="ustr">ms/qadam</span>
        </div>
        <button class="btn" id="abtn" onclick="aGo()">‚ö° Auto</button>
        <button class="btn btn-danger" onclick="aStop()">‚èπ To'xtat</button>
        <button class="btn" onclick="init()">‚Ü∫ Reset</button>
        <div class="step-ctr">Qadam: <b id="sc">0</b></div>
      </div>

      <div class="ks-card">
        <div class="ks-label">Keystream Chiqishi</div>
        <div class="ks-bits" id="kso"></div>
      </div>

      <div class="log-head">Qadam Jurnali</div>
      <div class="log-box" id="lg"></div>
    </div>

    <!-- ‚ïê‚ïê ENCRYPT ‚ïê‚ïê -->
    <div id="t-enc" class="tab">
      <div class="module-header">
        <div class="module-num">3</div>
        <div><div class="module-title">Shifrlash</div><div class="module-sub">A5/1 bilan matnni shifrlang va natijani ko'ring</div></div>
      </div>
      <div class="card">
        <div class="card-label">Kirish Ma'lumotlari</div>
        <div class="form-group" style="margin-bottom:16px">
          <label class="form-label">Asl matn (Plaintext)</label>
          <input class="form-input" type="text" id="pt" value="SALOM" maxlength="16">
          <span class="form-hint">Maksimal 16 ta belgi</span>
        </div>
        <div class="grid-3">
          <div class="form-group"><label class="form-label">R1 seed (hex)</label><input class="form-input" type="text" id="er1" value="1ABCD"></div>
          <div class="form-group"><label class="form-label">R2 seed (hex)</label><input class="form-input" type="text" id="er2" value="2F3A1"></div>
          <div class="form-group"><label class="form-label">R3 seed (hex)</label><input class="form-input" type="text" id="er3" value="5C2B7"></div>
        </div>
        <button class="btn btn-primary" onclick="enc()">üîê Shifrlash</button>
      </div>
      <div class="card" id="eo" style="display:none">
        <div class="card-label">Shifrlash Natijasi</div>
        <div id="er"></div>
      </div>
    </div>

    <!-- ‚ïê‚ïê QUIZ ‚ïê‚ïê -->
    <div id="t-quiz" class="tab">
      <div class="module-header">
        <div class="module-num">4</div>
        <div><div class="module-title">Bilim Tekshiruvi</div><div class="module-sub">25 ta savol orqali o'z bilimingizni sinab ko'ring</div></div>
      </div>
      <div class="card" style="max-width:720px">
        <div id="qb"></div>
      </div>
    </div>

  </div><!-- /content -->
</div><!-- /main -->

<div class="footer">
  <strong>CryptoLearn</strong> &nbsp;¬∑&nbsp; A5/1 Kriptografiya Kursi &nbsp;¬∑&nbsp; O'quv maqsadida yaratilgan
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ANIMATED CRYPTO BACKGROUND (Light theme)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
(() => {
  const cv = document.getElementById('bgc');
  const cx = cv.getContext('2d');
  let W, H;
  const sz = () => { W = cv.width = innerWidth; H = cv.height = innerHeight; };
  sz(); addEventListener('resize', sz);

  // Light gradient base
  const drawBg = () => {
    const g = cx.createLinearGradient(0, 0, W, H);
    g.addColorStop(0,   '#eef4ff');
    g.addColorStop(0.4, '#f5f8ff');
    g.addColorStop(0.8, '#f0faff');
    g.addColorStop(1,   '#eefaf5');
    cx.fillStyle = g; cx.fillRect(0, 0, W, H);
  };

  // Binary falling chars
  class BChar {
    constructor() { this.reset(true); }
    reset(init) {
      this.x = Math.random() * W;
      this.y = init ? Math.random() * H : -16;
      this.ch = Math.random() < .5 ? '0' : '1';
      this.a  = Math.random() * 0.07 + 0.02;
      this.sz = Math.floor(Math.random() * 5 + 9);
      this.sp = Math.random() * 0.55 + 0.15;
      const r = Math.random();
      this.col = r < .4 ? '0,86,210' : r < .7 ? '0,163,163' : '26,127,100';
    }
    tick()  { this.y += this.sp; if (this.y > H + 16) this.reset(false); }
    draw()  {
      cx.save();
      cx.font = `${this.sz}px JetBrains Mono,monospace`;
      cx.fillStyle = `rgba(${this.col},${this.a})`;
      cx.fillText(this.ch, this.x, this.y);
      cx.restore();
    }
  }

  // Floating crypto symbols
  class CSym {
    constructor() { this.reset(); }
    reset() {
      this.x = Math.random() * W; this.y = Math.random() * H;
      const syms = ['‚äï','‚äó','‚àß','‚à®','¬¨','01','10','0x'];
      this.ch  = syms[Math.floor(Math.random() * syms.length)];
      this.sz  = Math.floor(Math.random() * 10 + 11);
      this.col = Math.random() < .5 ? '0,86,210' : '0,163,163';
      this.a   = Math.random() * 0.06 + 0.01;
      this.life = 0; this.max = Math.random() * 250 + 150;
    }
    tick() { this.life++; if (this.life > this.max) this.reset(); }
    draw() {
      const a = this.a * Math.sin(this.life / this.max * Math.PI);
      cx.save();
      cx.font = `${this.sz}px JetBrains Mono,monospace`;
      cx.fillStyle = `rgba(${this.col},${a})`;
      cx.fillText(this.ch, this.x, this.y);
      cx.restore();
    }
  }

  // Nodes & connections
  class Node {
    constructor() {
      this.x = Math.random() * W; this.y = Math.random() * H;
      this.vx = (Math.random() - .5) * .35; this.vy = (Math.random() - .5) * .35;
      this.r = Math.random() * 2.5 + 1;
      const r = Math.random();
      this.c = r < .4 ? '0,86,210' : r < .7 ? '0,163,163' : '26,127,100';
    }
    tick() {
      this.x += this.vx; this.y += this.vy;
      if (this.x < 0 || this.x > W) this.vx *= -1;
      if (this.y < 0 || this.y > H) this.vy *= -1;
    }
    draw() {
      cx.beginPath(); cx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
      cx.fillStyle = `rgba(${this.c},.25)`; cx.fill();
    }
  }

  // Ripple pulses
  const pulses = [];
  setInterval(() => {
    if (pulses.length < 7) {
      const c = Math.random() < .5 ? '0,86,210' : '0,163,163';
      pulses.push({ x: Math.random()*W, y: Math.random()*H, r: 0, maxR: Math.random()*100+50, a: 0.15, c });
    }
  }, 1100);

  const bchars = Array.from({length:110}, () => new BChar());
  const syms   = Array.from({length:22},  () => new CSym());
  const nodes  = Array.from({length:32},  () => new Node());

  const loop = () => {
    cx.clearRect(0, 0, W, H);
    drawBg();

    // connections
    for (let i = 0; i < nodes.length; i++) {
      for (let j = i+1; j < nodes.length; j++) {
        const dx = nodes[i].x - nodes[j].x, dy = nodes[i].y - nodes[j].y;
        const d  = Math.sqrt(dx*dx + dy*dy);
        if (d < 155) {
          cx.beginPath();
          cx.moveTo(nodes[i].x, nodes[i].y);
          cx.lineTo(nodes[j].x, nodes[j].y);
          cx.strokeStyle = `rgba(0,86,210,${(1-d/155)*0.09})`;
          cx.lineWidth = .7; cx.stroke();
        }
      }
    }

    bchars.forEach(b => { b.tick(); b.draw(); });
    nodes.forEach(n  => { n.tick(); n.draw(); });
    syms.forEach(s   => { s.tick(); s.draw(); });

    for (let i = pulses.length-1; i >= 0; i--) {
      const p = pulses[i];
      cx.beginPath(); cx.arc(p.x, p.y, p.r, 0, Math.PI*2);
      cx.strokeStyle = `rgba(${p.c},${p.a*(1-p.r/p.maxR)})`;
      cx.lineWidth = 1.2; cx.stroke();
      p.r += 0.55; if (p.r > p.maxR) pulses.splice(i, 1);
    }

    requestAnimationFrame(loop);
  };
  loop();
})();

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   A5/1 CORE ENGINE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let R1, R2, R3, SC, AI, KB;
const T1=[13,16,17,18], T2=[20,21], T3=[7,20,21,22];
const CK1=8, CK2=10, CK3=10;
const $   = id => document.getElementById(id);
const h2b = (h, n) => { let v=parseInt(h,16)||0; v&=(1<<n)-1; const b=[]; for(let i=0;i<n;i++) b.push((v>>(n-1-i))&1); return b; };
const maj = (a,b,c) => (a&b)|(b&c)|(a&c);
const clk = (r,t)   => { let f=0; t.forEach(i=>f^=r[i]); for(let i=0;i<r.length-1;i++) r[i]=r[i+1]; r[r.length-1]=f; };

function core() {
  const c1=R1[CK1],c2=R2[CK2],c3=R3[CK3],m=maj(c1,c2,c3),cl=[];
  if(c1===m){clk(R1,T1);cl.push('R1');}
  if(c2===m){clk(R2,T2);cl.push('R2');}
  if(c3===m){clk(R3,T3);cl.push('R3');}
  const o=R1[18]^R2[21]^R3[22]; SC++; KB.push(o);
  return{c1,c2,c3,m,cl,o};
}

function init() {
  R1=h2b($('s1').value||'1ABCD',19);
  R2=h2b($('s2').value||'2F3A1',22);
  R3=h2b($('s3').value||'5C2B7',23);
  SC=0; KB=[];
  $('kso').innerHTML=''; $('lg').innerHTML=''; $('sc').textContent='0';
  drawAll(); majUpd();
  ['pr1','pr2','pr3'].forEach(id => $(id).className='lfsr-card');
}

function rnd() {
  const r = () => Math.floor(Math.random()*0xFFFFF).toString(16).toUpperCase();
  $('s1').value=r(); $('s2').value=r(); $('s3').value=r(); init();
}

function drawReg(id,reg,n,taps,ck) {
  const el=$(id); el.innerHTML='';
  reg.forEach((b,i) => {
    const d=document.createElement('div'); d.className='bit';
    if(b) d.classList.add('on'+n);
    if(taps.includes(i)) d.classList.add('tp'+n);
    const ix=document.createElement('span'); ix.className='bit-i'; ix.textContent=i; d.appendChild(ix);
    if(i===ck){const c=document.createElement('span');c.className='bit-c';c.textContent='‚ñ≤clk';d.appendChild(c);}
    d.appendChild(document.createTextNode(b));
    el.appendChild(d);
  });
}

function drawAll() {
  drawReg('br1',R1,1,T1,CK1);
  drawReg('br2',R2,2,T2,CK2);
  drawReg('br3',R3,3,T3,CK3);
}

function majUpd() {
  const c1=R1[CK1],c2=R2[CK2],c3=R3[CK3],m=maj(c1,c2,c3);
  $('mj1').textContent=c1; $('mj2').textContent=c2;
  $('mj3').textContent=c3; $('mjv').textContent=m;
}

function s1() {
  const r=core(); drawAll(); majUpd();
  $('sc').textContent=SC;
  // highlight fired panels
  [['pr1','R1','fire1'],['pr2','R2','fire2'],['pr3','R3','fire3']].forEach(([pid,nm,cls])=>{
    $(pid).className='lfsr-card'+(r.cl.includes(nm)?' '+cls:'');
  });
  // keystream chip
  if(KB.length<=96){
    const s=document.createElement('span'); s.className='ksb k'+r.o; s.textContent=r.o;
    $('kso').appendChild(s);
  }
  // majority info
  $('mji').innerHTML=
    `<span style="color:#60a5fa;font-weight:700">Maj=${r.m}</span>&nbsp; `+
    `<span style="color:#fbbf24;font-weight:700">‚ü≥ ${r.cl.join('+')||'‚Äî'}</span>&nbsp; `+
    `<span style="color:#6ee7b7;font-weight:700">Out:${r.o}</span>`;
  // log
  const lb=$('lg'), e=document.createElement('div');
  e.innerHTML=`<span class="ln">#${SC} </span>C=(${r.c1},${r.c2},${r.c3}) maj=<span class="lc">${r.m}</span>‚Üí<span class="lw">‚ü≥${r.cl.join('+')||'‚Äî'}</span>‚Üíout:<span class="lo">${r.o}</span>`;
  lb.appendChild(e); lb.scrollTop=lb.scrollHeight;
}

function sN() { const n=Math.min(parseInt($('ni').value)||10,2000); for(let i=0;i<n;i++) s1(); }

function aGo() {
  if(AI) return;
  const ms=Math.max(10,parseInt($('sp').value)||200);
  AI=setInterval(s1,ms); $('abtn').classList.add('disabled');
}
function aStop() { clearInterval(AI); AI=null; $('abtn').classList.remove('disabled'); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ENCRYPT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function enc() {
  const txt=$('pt').value||'SALOM';
  let r1=h2b($('er1').value,19), r2=h2b($('er2').value,22), r3=h2b($('er3').value,23);
  const pb=[]; for(const c of txt){const cd=c.charCodeAt(0);for(let i=7;i>=0;i--)pb.push((cd>>i)&1);}
  let tr1=[...r1],tr2=[...r2],tr3=[...r3];
  const st=()=>{
    const c1=tr1[CK1],c2=tr2[CK2],c3=tr3[CK3],m=maj(c1,c2,c3);
    if(c1===m)clk(tr1,T1); if(c2===m)clk(tr2,T2); if(c3===m)clk(tr3,T3);
    return tr1[18]^tr2[21]^tr3[22];
  };
  const kb=pb.map(()=>st());
  const cb=pb.map((b,i)=>b^kb[i]);
  let hex=''; for(let i=0;i<cb.length;i+=8){let by=0;for(let j=0;j<8;j++)by=(by<<1)|cb[i+j];hex+='0x'+by.toString(16).toUpperCase()+' ';}
  const rows=$('er'); rows.innerHTML='';
  [{l:'Plaintext',b:pb,c:'ep'},{l:'Keystream ‚äï',b:kb,c:'ek'},{l:'Ciphertext',b:cb,c:'ec'}].forEach((row,ri)=>{
    const el=document.createElement('div'); el.className='enc-row';
    const lbl=document.createElement('div'); lbl.className='enc-l'; lbl.textContent=row.l; el.appendChild(lbl);
    if(ri===1){const x=document.createElement('span');x.className='xop';x.textContent='‚äï';el.appendChild(x);}
    const be=document.createElement('div'); be.className='enc-bits';
    row.b.forEach((b,i)=>{
      if(i>0&&i%8===0){const sp=document.createElement('div');sp.style.width='5px';be.appendChild(sp);}
      const bd=document.createElement('div'); bd.className='eb '+row.c; bd.textContent=b; be.appendChild(bd);
    });
    el.appendChild(be);
    if(ri===2){const h=document.createElement('div');h.className='hex-tag';h.textContent=hex.trim();el.appendChild(h);}
    rows.appendChild(el);
  });
  $('eo').style.display='block';
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   QUIZ ‚Äî 25 SAVOL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const QS=[
  {q:"A5/1 algoritmida nechta LFSR mavjud?",                                     o:["2 ta","3 ta","4 ta","5 ta"],                                                                                  a:1},
  {q:"A5/1 qaysi mobil aloqa standartida ishlatiladi?",                           o:["CDMA","Wi-Fi 802.11","GSM","LTE/4G"],                                                                        a:2},
  {q:"Keystream biti qanday hosil qilinadi?",                                      o:["AND amaliyoti","OR amaliyoti","XOR amaliyoti","NOT amaliyoti"],                                              a:2},
  {q:"A5/1 qanday turdagi shifrga kiradi?",                                       o:["Blok shifri","Oqim shifri (stream cipher)","Assimetrik shifr","Hash funksiyasi"],                            a:1},
  {q:"A5/1 algoritmi qaysi yilda ishlab chiqilgan?",                              o:["1975","1980","1987","1993"],                                                                                  a:2},
  {q:"R1 registrining uzunligi necha bit?",                                        o:["16 bit","19 bit","22 bit","23 bit"],                                                                         a:1},
  {q:"R2 registrining uzunligi necha bit?",                                        o:["19 bit","20 bit","22 bit","24 bit"],                                                                         a:2},
  {q:"R3 registrining uzunligi necha bit?",                                        o:["21 bit","22 bit","23 bit","25 bit"],                                                                         a:2},
  {q:"R1 registrining clocking biti qaysi pozitsiyada?",                           o:["bit[5]","bit[8]","bit[10]","bit[13]"],                                                                      a:1},
  {q:"R2 va R3 registrlarining clocking bitlari qaysi pozitsiyada?",               o:["bit[5]","bit[8]","bit[10]","bit[12]"],                                                                      a:2},
  {q:"R1 registrining tap pozitsiyalari qaysilar?",                               o:["8, 11, 12, 13","13, 16, 17, 18","10, 14, 15, 18","5, 9, 12, 18"],                                           a:1},
  {q:"R2 registrining tap pozitsiyalari qaysilar?",                               o:["18, 19","20, 21","21, 22","19, 20"],                                                                         a:1},
  {q:"R3 registrining tap pozitsiyalari qaysilar?",                               o:["6, 18, 20, 22","7, 20, 21, 22","8, 19, 21, 22","5, 18, 20, 21"],                                            a:1},
  {q:"R1 registrining chiqish (output) biti qaysi pozitsiyada?",                  o:["bit[15]","bit[17]","bit[18]","bit[19]"],                                                                     a:2},
  {q:"R3 registrining chiqish biti qaysi pozitsiyada?",                           o:["bit[20]","bit[21]","bit[22]","bit[23]"],                                                                     a:2},
  {q:"Ko'pchilik qoidasi (majority rule) nimani aniqlaydi?",                      o:["Keystream bitini","Qaysi registrlar siljishini","XOR natijasini","Registr uzunligini"],                      a:1},
  {q:"majority(1, 0, 1) ning natijasi nima?",                                     o:["0","1","Noaniq","2"],                                                                                        a:1},
  {q:"majority(0, 0, 1) ning natijasi nima?",                                     o:["0","1","XOR","AND"],                                                                                         a:0},
  {q:"Har bir soat zarbida kamida nechta registr siljiydi?",                      o:["1 ta","2 ta","3 ta","Hech biri"],                                                                            a:1},
  {q:"'Irregular clocking' deganda nima tushuniladi?",                            o:["Barcha registrlar bir vaqtda siljiydi","Faqat bitta registr ishlaydi","Har doim turli sondagi registrlar siljiydi","Random tartibda siljiydi"], a:2},
  {q:"A5/1 ning keystream formulasi qaysi?",                                      o:["R1[0]‚äïR2[0]‚äïR3[0]","R1[18]‚äïR2[21]‚äïR3[22]","R1[8]‚äïR2[10]‚äïR3[10]","R1[13]‚äïR2[20]‚äïR3[7]"],              a:1},
  {q:"Shifrlashda keystream bilan qanday amal bajariladi?",                       o:["AND","OR","XOR","XNOR"],                                                                                     a:2},
  {q:"A5/1 ning asosiy zaif tomoni nima?",                                        o:["Registrlar soni kam","Kalit uzunligi qisqa","Real vaqtda hujumlarga moyilligi","Faqat matn shifrlay oladi"],  a:2},
  {q:"LFSR da yangi bit qanday hosil qilinadi?",                                  o:["Random generator orqali","Tap pozitsiyalar XOR orqali","Hash funksiyasi orqali","Tashqi kalit orqali"],      a:1},
  {q:"A5/1 da barcha registrlar uzunliklari yig'indisi nechaga teng?",            o:["55 bit","63 bit","64 bit","128 bit"],                                                                        a:2},
];

let QSC=0, QCR=0, QDN=false;

function renderQ() {
  const box=$('qb');
  if(QCR>=QS.length){
    const p=Math.round(QSC/QS.length*100);
    const grade=QSC>=20?'Mukammal!':QSC>=15?'A\'lo!':QSC>=10?'Yaxshi':QSC>=6?'Qoniqarli':'Qaytadan o\'qing';
    box.innerHTML=`
      <div class="qprog-wrap"><div class="qprog-fill" style="width:100%"></div></div>
      <div style="text-align:center;padding:28px 0">
        <div style="font-size:60px;margin-bottom:16px">${QSC>=20?'üèÜ':QSC>=15?'ü•á':QSC>=10?'üëç':'üìö'}</div>
        <div style="font-size:42px;font-weight:800;color:var(--blue);letter-spacing:-1.5px">${QSC}<span style="color:var(--gray-300)">/</span>${QS.length}</div>
        <div style="font-size:18px;font-weight:700;color:var(--gray-700);margin:8px 0 4px">${grade}</div>
        <div style="font-size:14px;color:var(--gray-500);margin-bottom:28px">${p}% to'g'ri javob &nbsp;¬∑&nbsp; ${QS.length-QSC} xato</div>
        <button class="btn btn-primary" onclick="resetQ()" style="font-size:15px;padding:12px 28px">‚Ü∫ Qaytadan boshlash</button>
      </div>`;
    return;
  }
  const q=QS[QCR], p=Math.round(QCR/QS.length*100);
  box.innerHTML=`
    <div class="qprog-wrap"><div class="qprog-fill" style="width:${p}%"></div></div>
    <div class="q-meta"><span>Savol ${QCR+1} / ${QS.length}</span><span style="color:var(--blue);font-weight:700">Ball: ${QSC}</span></div>
    <div class="q-text">${q.q}</div>
    <div class="q-opts">
      ${q.o.map((op,i)=>`<button class="q-opt" id="qo${i}" onclick="ansQ(${i})">
        <span class="qk">${String.fromCharCode(65+i)}</span>${op}
      </button>`).join('')}
    </div>`;
}

function ansQ(ch) {
  if(QDN) return; QDN=true;
  const q=QS[QCR];
  document.querySelectorAll('.q-opt').forEach((b,i)=>{
    b.disabled=true;
    if(i===q.a) b.classList.add('ok');
    else if(i===ch&&ch!==q.a) b.classList.add('fail');
  });
  if(ch===q.a) QSC++;
  setTimeout(()=>{QCR++;QDN=false;renderQ();},1300);
}
function resetQ(){QSC=0;QCR=0;QDN=false;renderQ();}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   TAB & SIDEBAR NAVIGATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function go(name) {
  const tabs=['theory','vis','enc','quiz'];

  // topbar buttons
  document.querySelectorAll('.topnav-btn').forEach((b,i) => b.classList.toggle('active', tabs[i]===name));

  // sidebar items
  document.querySelectorAll('.sidebar-item').forEach((b,i) => b.classList.toggle('active', tabs[i]===name));

  // tabs
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('on'));
  $('t-'+name).classList.add('on');

  if(name==='quiz') renderQ();
}

/* BOOT */
init();
</script>
</body>
</html>
